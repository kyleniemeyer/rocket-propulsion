
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Thermochemistry &#8212; Rocket Propulsion Notes</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Implementing CEA calculations using Cantera" href="cea_cantera.html" />
    <link rel="prev" title="Ideal rocket analysis" href="../fundamentals/ideal-rocket.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Rocket Propulsion Notes</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Rocket Propulsion notes
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../solving-tips.html">
   Problem-solving tips
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Fundamentals
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../fundamentals/thrust-rocket-equation.html">
   Thrust and the rocket equation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../fundamentals/staging.html">
   Rocket staging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../fundamentals/ideal-rocket.html">
   Ideal rocket analysis
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Thermochemistry
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Thermochemistry
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cea_cantera.html">
   Implementing CEA calculations using Cantera
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chemical propulsion
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../chemical-rockets/hybrid-rockets.html">
   Hybrid Rocket Motors
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Reference
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../zbibliography.html">
   Bibliography
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../contributing.html">
   Contributing to this book
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/thermochemistry/thermochemistry.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/kyleniemeyer/rocket-propulsion"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/kyleniemeyer/rocket-propulsion/issues/new?title=Issue%20on%20page%20%2Fthermochemistry/thermochemistry.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/kyleniemeyer/rocket-propulsion/edit/main/book/thermochemistry/thermochemistry.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/kyleniemeyer/rocket-propulsion/main?urlpath=tree/book/thermochemistry/thermochemistry.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fixed-temperature-and-pressure">
   Fixed temperature and pressure
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#adiabatic-combustion">
   Adiabatic combustion
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rocket-problem">
   Rocket problem
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#oxidizer-to-fuel-ratio">
   Oxidizer-to-fuel ratio
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#frozen-vs-shifting-equilibrium">
   Frozen vs. shifting equilibrium
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Thermochemistry</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fixed-temperature-and-pressure">
   Fixed temperature and pressure
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#adiabatic-combustion">
   Adiabatic combustion
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rocket-problem">
   Rocket problem
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#oxidizer-to-fuel-ratio">
   Oxidizer-to-fuel ratio
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#frozen-vs-shifting-equilibrium">
   Frozen vs. shifting equilibrium
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="thermochemistry">
<h1>Thermochemistry<a class="headerlink" href="#thermochemistry" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this line makes figures interactive in Jupyter notebooks</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">root_scalar</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">constants</span>

<span class="kn">from</span> <span class="nn">pint</span> <span class="kn">import</span> <span class="n">UnitRegistry</span>
<span class="n">ureg</span> <span class="o">=</span> <span class="n">UnitRegistry</span><span class="p">()</span>
<span class="n">Q_</span> <span class="o">=</span> <span class="n">ureg</span><span class="o">.</span><span class="n">Quantity</span>

<span class="c1"># for convenience:</span>
<span class="k">def</span> <span class="nf">to_si</span><span class="p">(</span><span class="n">quant</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Converts a Pint Quantity to magnitude at base SI units.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">quant</span><span class="o">.</span><span class="n">to_base_units</span><span class="p">()</span><span class="o">.</span><span class="n">magnitude</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># these lines are only for helping improve the display</span>
<span class="kn">import</span> <span class="nn">matplotlib_inline.backend_inline</span>
<span class="n">matplotlib_inline</span><span class="o">.</span><span class="n">backend_inline</span><span class="o">.</span><span class="n">set_matplotlib_formats</span><span class="p">(</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span> <span class="s1">&#39;png&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span><span class="o">=</span> <span class="mi">300</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;savefig.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">300</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;mathtext.fontset&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;cm&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define some constants</span>
<span class="n">Ru</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">R</span><span class="p">,</span> <span class="s1">&#39;J/(K*mol)&#39;</span><span class="p">)</span>
<span class="n">g0</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">g</span><span class="p">,</span> <span class="s1">&#39;m/s^2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The thermochemical performance of a rocket is primarily represented using the characteristic velocity:</p>
<div class="math notranslate nohighlight" id="equation-eq-cstar">
<span class="eqno">(6)<a class="headerlink" href="#equation-eq-cstar" title="Permalink to this equation">¶</a></span>\[
c^* = \frac{p_c A_t}{\dot{m}} = \sqrt{\frac{\mathcal{R}_u T_c}{\textrm{MW} \, \gamma} \left( \frac{\gamma + 1}{2} \right)^{\frac{\gamma+1}{\gamma-1}} } \;,
\]</div>
<p>which depends on the (combustion) chamber temperature <span class="math notranslate nohighlight">\(T_c\)</span>, gas molecular weight <span class="math notranslate nohighlight">\(\textrm{MW}\)</span>, and gas specific heat ratio <span class="math notranslate nohighlight">\(\gamma\)</span>.
The thrust coefficient <span class="math notranslate nohighlight">\(C_F\)</span> mainly represents the performance of the nozzle, but it also depends on the specific heat ratio <span class="math notranslate nohighlight">\(\gamma\)</span>.</p>
<p>Up to this point, we have been provided or assumed these values, but they are actually a function of</p>
<ul class="simple">
<li><p>propellant(s)</p></li>
<li><p>ratio of oxidizer to fuel</p></li>
</ul>
<p>Given a propellant or combination of propellants and heating (due to combustion, nuclear reactions, or electricity),
the gas in the chamber and moving into the nozzle will form a mixture of chemical species at the state of chemical equilibrium. At this state, the forward and reverse rates of all chemical reactions are balanced, and the species remain at a fixed composition (as long as the temperature and/or pressure remain constant).</p>
<p>The amounts of the chemical species at the equilibrium are unknown, but can be determined based on the initial conditions using methods based on <a class="reference external" href="https://kyleniemeyer.github.io/computational-thermo/content/chemical-equilibrium/equilibrium-constant.html">reaction equilibrium constants</a> or the <a class="reference external" href="https://kyleniemeyer.github.io/computational-thermo/content/chemical-equilibrium/equilibrium-alternative-methods.html">minimization of Gibbs free energy</a>.
If the temperature is not known/fixed, then it is also an unknown and must be found.</p>
<p>Fortunately, we can use software tools such as NASA’s <a class="reference external" href="https://cearun.grc.nasa.gov">CEA</a> or <a class="reference external" href="https://cantera.org">Cantera</a> to find the equilibrium state for us. We’ll focus on CEA here.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_area_ratio</span><span class="p">(</span><span class="n">pressure_ratio</span><span class="p">,</span> <span class="n">gamma</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Calculates area ratio based on specific heat ratio and pressure ratio.</span>
<span class="sd">    pressure ratio: chamber / exit</span>
<span class="sd">    area ratio: exit / throat</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">gamma</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">*</span> 
        <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">pressure_ratio</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">gamma</span><span class="p">)</span> <span class="o">*</span>
        <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span>
                <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">pressure_ratio</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">gamma</span><span class="p">)</span><span class="o">/</span><span class="n">gamma</span><span class="p">))</span>
                <span class="p">)</span>
        <span class="p">)</span>

<span class="k">def</span> <span class="nf">root_area_ratio</span><span class="p">(</span><span class="n">pressure_ratio</span><span class="p">,</span> <span class="n">area_ratio</span><span class="p">,</span> <span class="n">gamma</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Returns zero for a given area ratio, pressure ratio, and gamma.</span>
<span class="sd">    pressure ratio: chamber / exit</span>
<span class="sd">    area ratio: exit / throat</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">area_ratio</span> <span class="o">-</span> <span class="n">get_area_ratio</span><span class="p">(</span><span class="n">pressure_ratio</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_thrust_coeff</span><span class="p">(</span><span class="n">pressure_ratio</span><span class="p">,</span> <span class="n">gamma</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Calculates thrust coefficient for optimum expansion.</span>
<span class="sd">    pressure ratio: chamber / exit</span>
<span class="sd">    area ratio: exit / throat</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
        <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">gamma</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> 
        <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> 
        <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">pressure_ratio</span><span class="p">,</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">gamma</span><span class="p">))</span>
        <span class="p">)</span>

<span class="k">def</span> <span class="nf">get_cstar</span><span class="p">(</span><span class="n">Tc</span><span class="p">,</span> <span class="n">MW</span><span class="p">,</span> <span class="n">gamma</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Calculates cstar using chamber properties.&#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Ru</span> <span class="o">*</span> <span class="n">Tc</span> <span class="o">/</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">*</span> <span class="n">MW</span><span class="p">))</span> <span class="o">*</span> 
        <span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">gamma</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
        <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="fixed-temperature-and-pressure">
<h2>Fixed temperature and pressure<a class="headerlink" href="#fixed-temperature-and-pressure" title="Permalink to this headline">¶</a></h2>
<p>Let’s first consider the problem where the pressure and temperature of the combustion/heating chamber are fixed and known, and determine the equilibrium composition of chemical species.
This problem is relevant to an isothermal process, or where temperature is a design variable, such
as in nuclear thermal or electrothermal rockets.</p>
<p>For example, say we have an arcjet operating on gaseous hydrazine (N<sub>2</sub>H<sub>4</sub>)
as a propellant, with a chamber temperature of 5000 K and pressure of 50 psia.
The nozzle area ratio is 100, and the arcjet will operate in vacuum.
For this system, determine the equilibrium composition, the average molecular weight, ratio of specific heats <span class="math notranslate nohighlight">\(\gamma\)</span>,
and then use these to get <span class="math notranslate nohighlight">\(c^*\)</span>, <span class="math notranslate nohighlight">\(C_F\)</span>, and <span class="math notranslate nohighlight">\(I_{\textrm{sp}}\)</span>.</p>
<p>In <a class="reference external" href="https://cearun.grc.nasa.gov/">CEA</a>, this is a <code class="docutils literal notranslate"><span class="pre">tp</span></code> problem, or fixed temperature and pressure problem.
We should expect that, at such high temperatures, the equilibrium state will have mostly one- and two-atom
molecules, based on the elements present: N<sub>2</sub>, H<sub>2</sub>, H, N, and HN.</p>
<p>The CEA plaintext input file looks like:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>prob tp
 
p,psia= 50  t,k= 5000

reac
name N2H4 mol 1.0

output siunits
end
</pre></div>
</div>
<p>and the output is (with the repeated input removed):</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>*******************************************************************************

         NASA-GLENN CHEMICAL EQUILIBRIUM PROGRAM CEA2, FEBRUARY 5, 2004
                   BY  BONNIE MCBRIDE AND SANFORD GORDON
      REFS: NASA RP-1311, PART I, 1994 AND NASA RP-1311, PART II, 1996

 *******************************************************************************

               THERMODYNAMIC EQUILIBRIUM PROPERTIES AT ASSIGNED

                           TEMPERATURE AND PRESSURE

             REACTANT                    WT FRACTION      ENERGY      TEMP
                                          (SEE NOTE)     KJ/KG-MOL      K  
 NAME        N2H4                         1.0000000         0.000      0.000

 O/F=    0.00000  %FUEL=  0.000000  R,EQ.RATIO= 0.000000  PHI,EQ.RATIO= 0.000000

 THERMODYNAMIC PROPERTIES

 P, BAR            3.4474
 T, K             5000.00
 RHO, KG/CU M    5.5368-2
 H, KJ/KG         42058.0
 U, KJ/KG         35831.8
 G, KJ/KG       -103744.4
 S, KJ/(KG)(K)    29.1605

 M, (1/n)           6.677
 (dLV/dLP)t      -1.04028
 (dLV/dLT)p        1.4750
 Cp, KJ/(KG)(K)   11.1350
 GAMMAs            1.2548
 SON VEL,M/SEC     2795.1

 MOLE FRACTIONS

 *H               0.74177
 *H2              0.04573
 *N               0.00806
 *NH              0.00021
 *N2              0.20422
</pre></div>
</div>
<p>So, CEA not only provides the equilibrium composition in terms of mole fraction (<span class="math notranslate nohighlight">\(X_i\)</span>), but
also the mean molecular weight of the mixture <span class="math notranslate nohighlight">\(MW\)</span>;
thermodynamic properties and derivatives density <span class="math notranslate nohighlight">\(\rho\)</span>, enthalpy <span class="math notranslate nohighlight">\(h\)</span>, entropy <span class="math notranslate nohighlight">\(s\)</span>,
<span class="math notranslate nohighlight">\(\left(\partial \log V / \partial \log P\right)_T\)</span>, <span class="math notranslate nohighlight">\(\left(\partial \log V / \partial \log T\right)_P\)</span>,
specific heat <span class="math notranslate nohighlight">\(C_p = \partial h / \partial T)_P\)</span>, the ratio of specific heats (<span class="math notranslate nohighlight">\(\gamma\)</span>),
and the sonic velocity (i.e., speed of sound) <span class="math notranslate nohighlight">\(a\)</span>. Some of these quantities are not particularly interesting to us right now, but we can use these quantities to find our quantities of interest.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">area_ratio</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">Tc</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">)</span>
<span class="n">Pc</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;psi&#39;</span><span class="p">)</span>

<span class="c1"># output from CEA</span>
<span class="n">MW</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mf">6.677</span><span class="p">,</span> <span class="s1">&#39;kg/kmol&#39;</span><span class="p">)</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="mf">1.2548</span>
</pre></div>
</div>
</div>
</div>
<p>First, we need to find the exit pressure of the nozzle based on the area ratio:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># initial guesses for Pc / Pe</span>
<span class="n">root</span> <span class="o">=</span> <span class="n">root_scalar</span><span class="p">(</span><span class="n">root_area_ratio</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">area_ratio</span><span class="p">,</span> <span class="n">gamma</span><span class="p">))</span>
<span class="n">Pc_Pe</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">root</span>
<span class="n">Pe</span> <span class="o">=</span> <span class="n">Pc</span> <span class="o">/</span> <span class="n">Pc_Pe</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exit pressure = </span><span class="si">{</span><span class="n">Pe</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;psi&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2"> .2e~P</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">cstar</span> <span class="o">=</span> <span class="n">get_cstar</span><span class="p">(</span><span class="n">Tc</span><span class="p">,</span> <span class="n">MW</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cstar = </span><span class="si">{</span><span class="n">cstar</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;m/s&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2"> .1f~P</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">CF0</span> <span class="o">=</span> <span class="n">get_thrust_coeff</span><span class="p">(</span><span class="n">Pc_Pe</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>
<span class="c1"># ambient pressure is zero in vacuum</span>
<span class="n">CF</span> <span class="o">=</span> <span class="n">CF0</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">Pc_Pe</span><span class="p">)</span> <span class="o">*</span> <span class="n">area_ratio</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;C_F = </span><span class="si">{</span><span class="n">CF</span><span class="si">:</span><span class="s2"> .3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Exit pressure = 2.54e-02 psi
Cstar = 3786.6 m/s
C_F =  1.884
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Isp</span> <span class="o">=</span> <span class="n">CF</span> <span class="o">*</span> <span class="n">cstar</span> <span class="o">/</span> <span class="n">g0</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Isp = </span><span class="si">{</span><span class="n">Isp</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2"> .1f~P</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Isp = 727.4 s
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="adiabatic-combustion">
<h2>Adiabatic combustion<a class="headerlink" href="#adiabatic-combustion" title="Permalink to this headline">¶</a></h2>
<p>For chemical rockets, the temperature in the combustion chamber is unknown, and is a function of the propellant combination, oxidizer/fuel ratio, and chamber pressure.</p>
<p>Consider the Space Shuttle Main Engine (SSME, also known as the RS-25),
which uses liquid oxygen and liquid hydrogen as propellants, at an O/F ratio of 6.0 and
with a chamber pressure of 2870 psia.
The engine nozzle has an area ratio of 68.8.</p>
<p>Find the chamber temperature, mole fractions of equilibrium products, specific heat ratio,
average molecular weight, <span class="math notranslate nohighlight">\(c^*\)</span>, <span class="math notranslate nohighlight">\(C_F\)</span>, and specific impulse at sea level.</p>
<p>In CEA, this is an <code class="docutils literal notranslate"><span class="pre">hp</span></code> type problem (assigned enthalpy and pressure), where the enthalpy of the initial mixture is known based on the propellants and combustion is assumed to be adiabatic.</p>
<p>The CEA plaintext input file (with some comments removed) looks like:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>prob hp
 
# Pressure (1 value):
p,psia= 2870
  
# Oxidizer/Fuel Wt. ratio (1 value):
o/f= 6.0
 
reac
fuel H2(L)             wt%=100.0000
oxid O2(L)             wt%=100.0000

output short
output siunits

end
</pre></div>
</div>
<p>and the output is (with the repeated input removed):</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>*******************************************************************************

         NASA-GLENN CHEMICAL EQUILIBRIUM PROGRAM CEA2, FEBRUARY 5, 2004
                   BY  BONNIE MCBRIDE AND SANFORD GORDON
      REFS: NASA RP-1311, PART I, 1994 AND NASA RP-1311, PART II, 1996

 *******************************************************************************

         THERMODYNAMIC EQUILIBRIUM COMBUSTION PROPERTIES AT ASSIGNED

                                   PRESSURES

 CASE = _______________

             REACTANT                    WT FRACTION      ENERGY      TEMP
                                          (SEE NOTE)     KJ/KG-MOL      K  
 FUEL        H2(L)                        1.0000000     -9012.000     20.270
 OXIDANT     O2(L)                        1.0000000    -12979.000     90.170

 O/F=    6.00000  %FUEL= 14.285714  R,EQ.RATIO= 1.322780  PHI,EQ.RATIO= 1.322780

 THERMODYNAMIC PROPERTIES

 P, BAR            197.88
 T, K             3594.37
 RHO, KG/CU M    9.0105 0
 H, KJ/KG         -986.31
 U, KJ/KG        -3182.40
 G, KJ/KG        -62790.6
 S, KJ/(KG)(K)    17.1948

 M, (1/n)          13.608
 (dLV/dLP)t      -1.01921
 (dLV/dLT)p        1.3335
 Cp, KJ/(KG)(K)    7.3661
 GAMMAs            1.1472
 SON VEL,M/SEC     1587.2

 MOLE FRACTIONS

 *H               0.02575
 HO2              0.00003
 *H2              0.24744
 H2O              0.68555
 H2O2             0.00002
 *O               0.00207
 *OH              0.03694
 *O2              0.00220

  * THERMODYNAMIC PROPERTIES FITTED TO 20000.K

 NOTE. WEIGHT FRACTION OF FUEL IN TOTAL FUELS AND OF OXIDANT IN TOTAL OXIDANTS
</pre></div>
</div>
<p>From the output, we see that the chamber temperature is 3594.37 K, the average molecular weight is 13.608 g/mol,
and the specific heat ratio <span class="math notranslate nohighlight">\(\gamma\)</span> is 1.1472. We also see that the equilibrium mixture contains mostly
H<span class="math notranslate nohighlight">\(_2\)</span>, H<span class="math notranslate nohighlight">\(_2\)</span>O, OH, H, and with some trace amounts of O, O<span class="math notranslate nohighlight">\(_2\)</span>, and H<span class="math notranslate nohighlight">\(_2\)</span>O<span class="math notranslate nohighlight">\(_2\)</span>.
We can use this information to find the quantities of interest:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">area_ratio</span> <span class="o">=</span> <span class="mf">68.8</span>
<span class="n">Pc</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mi">2870</span><span class="p">,</span> <span class="s1">&#39;psi&#39;</span><span class="p">)</span>
<span class="c1"># sea level</span>
<span class="n">Pa</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;atm&#39;</span><span class="p">)</span>

<span class="c1"># output from CEA</span>
<span class="n">Tc</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mf">3594.37</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">)</span>
<span class="n">MW</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mf">13.608</span><span class="p">,</span> <span class="s1">&#39;kg/kmol&#39;</span><span class="p">)</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="mf">1.1472</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># initial guesses for Pc / Pe</span>
<span class="n">root</span> <span class="o">=</span> <span class="n">root_scalar</span><span class="p">(</span><span class="n">root_area_ratio</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">area_ratio</span><span class="p">,</span> <span class="n">gamma</span><span class="p">))</span>
<span class="n">Pc_Pe</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">root</span>
<span class="n">Pe</span> <span class="o">=</span> <span class="n">Pc</span> <span class="o">/</span> <span class="n">Pc_Pe</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exit pressure = </span><span class="si">{</span><span class="n">Pe</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;psi&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2"> .2f~P</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">cstar</span> <span class="o">=</span> <span class="n">get_cstar</span><span class="p">(</span><span class="n">Tc</span><span class="p">,</span> <span class="n">MW</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cstar = </span><span class="si">{</span><span class="n">cstar</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;m/s&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2"> .1f~P</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;at sea level:&#39;</span><span class="p">)</span>
<span class="n">CF0</span> <span class="o">=</span> <span class="n">get_thrust_coeff</span><span class="p">(</span><span class="n">Pc_Pe</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>
<span class="n">CF</span> <span class="o">=</span> <span class="n">CF0</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">Pc_Pe</span> <span class="o">+</span> <span class="n">Pa</span><span class="o">/</span><span class="n">Pc</span><span class="p">)</span> <span class="o">*</span> <span class="n">area_ratio</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;C_F = </span><span class="si">{</span><span class="n">CF</span><span class="o">.</span><span class="n">to_base_units</span><span class="p">()</span><span class="si">:</span><span class="s2"> .3f~P</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">Isp</span> <span class="o">=</span> <span class="n">CF</span> <span class="o">*</span> <span class="n">cstar</span> <span class="o">/</span> <span class="n">g0</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Isp = </span><span class="si">{</span><span class="n">Isp</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2"> .1f~P</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Exit pressure = 3.81 psi
Cstar = 2322.5 m/s
at sea level:
C_F = 2.350
Isp = 556.5 s
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="rocket-problem">
<h2>Rocket problem<a class="headerlink" href="#rocket-problem" title="Permalink to this headline">¶</a></h2>
<p>CEA can also calculate performance quantities specific to rockets, such as the
effective velocity (C-star, <span class="math notranslate nohighlight">\(c^*\)</span>), thrust coefficient (<span class="math notranslate nohighlight">\(C_F\)</span>), and specific
impulse (<span class="math notranslate nohighlight">\(I_{\text{sp}}\)</span>).</p>
<p>To do this, it has to make an assumption of whether to</p>
<p>For the above example, but choosing the <code class="docutils literal notranslate"><span class="pre">rocket</span></code> problem and specifying a (supersonic) nozzle area ratio
of 68.8, and leaving other options at their defaults, CEA provides this output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="o">*******************************************************************************</span>

         <span class="n">NASA</span><span class="o">-</span><span class="n">GLENN</span> <span class="n">CHEMICAL</span> <span class="n">EQUILIBRIUM</span> <span class="n">PROGRAM</span> <span class="n">CEA2</span><span class="p">,</span> <span class="n">FEBRUARY</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2004</span>
                   <span class="n">BY</span>  <span class="n">BONNIE</span> <span class="n">MCBRIDE</span> <span class="n">AND</span> <span class="n">SANFORD</span> <span class="n">GORDON</span>
      <span class="n">REFS</span><span class="p">:</span> <span class="n">NASA</span> <span class="n">RP</span><span class="o">-</span><span class="mi">1311</span><span class="p">,</span> <span class="n">PART</span> <span class="n">I</span><span class="p">,</span> <span class="mi">1994</span> <span class="n">AND</span> <span class="n">NASA</span> <span class="n">RP</span><span class="o">-</span><span class="mi">1311</span><span class="p">,</span> <span class="n">PART</span> <span class="n">II</span><span class="p">,</span> <span class="mi">1996</span>

 <span class="o">*******************************************************************************</span>



  
 <span class="c1">### CEA analysis performed on Tue 08-Feb-2022 11:04:54</span>
  
 <span class="c1"># Problem Type: &quot;Rocket&quot; (Infinite Area Combustor)</span>
  
 <span class="n">prob</span> <span class="n">case</span><span class="o">=</span><span class="n">_______________8942</span> <span class="n">ro</span>
  
 <span class="c1"># Pressure (1 value):</span>
 <span class="n">p</span><span class="p">,</span><span class="n">psia</span><span class="o">=</span> <span class="mi">2870</span>
 <span class="c1"># Supersonic Area Ratio (1 value):</span>
 <span class="n">supar</span><span class="o">=</span> <span class="mf">68.8</span>
  
 <span class="c1"># Oxidizer/Fuel Wt. ratio (1 value):</span>
 <span class="n">o</span><span class="o">/</span><span class="n">f</span><span class="o">=</span> <span class="mf">6.0</span>
  
 <span class="c1"># You selected the following fuels and oxidizers:</span>
 <span class="n">reac</span>
 <span class="n">fuel</span> <span class="n">H2</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>             <span class="n">wt</span><span class="o">%=</span><span class="mf">100.0000</span>
 <span class="n">oxid</span> <span class="n">O2</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>             <span class="n">wt</span><span class="o">%=</span><span class="mf">100.0000</span>
  
 <span class="c1"># You selected these options for output:</span>
 <span class="c1"># short version of output</span>
 <span class="n">output</span> <span class="n">short</span>
 <span class="c1"># Proportions of any products will be expressed as Mole Fractions.</span>
 <span class="c1"># Heat will be expressed as siunits</span>
 <span class="n">output</span> <span class="n">siunits</span>
  
 <span class="c1"># Input prepared by this script:/var/www/sites/cearun.grc.nasa.gov/cgi-bin/CEARU</span>
 <span class="n">N</span><span class="o">/</span><span class="n">prepareInputFile</span><span class="o">.</span><span class="n">cgi</span>
  
 <span class="c1">### IMPORTANT:  The following line is the end of your CEA input file!</span>
 <span class="n">end</span>



           <span class="n">THEORETICAL</span> <span class="n">ROCKET</span> <span class="n">PERFORMANCE</span> <span class="n">ASSUMING</span> <span class="n">FROZEN</span> <span class="n">COMPOSITION</span>

 <span class="n">Pin</span> <span class="o">=</span>  <span class="mf">2870.0</span> <span class="n">PSIA</span>
 <span class="n">CASE</span> <span class="o">=</span> <span class="n">_______________</span>

             <span class="n">REACTANT</span>                    <span class="n">WT</span> <span class="n">FRACTION</span>      <span class="n">ENERGY</span>      <span class="n">TEMP</span>
                                          <span class="p">(</span><span class="n">SEE</span> <span class="n">NOTE</span><span class="p">)</span>     <span class="n">KJ</span><span class="o">/</span><span class="n">KG</span><span class="o">-</span><span class="n">MOL</span>      <span class="n">K</span>  
 <span class="n">FUEL</span>        <span class="n">H2</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>                        <span class="mf">1.0000000</span>     <span class="o">-</span><span class="mf">9012.000</span>     <span class="mf">20.270</span>
 <span class="n">OXIDANT</span>     <span class="n">O2</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>                        <span class="mf">1.0000000</span>    <span class="o">-</span><span class="mf">12979.000</span>     <span class="mf">90.170</span>

 <span class="n">O</span><span class="o">/</span><span class="n">F</span><span class="o">=</span>    <span class="mf">6.00000</span>  <span class="o">%</span><span class="n">FUEL</span><span class="o">=</span> <span class="mf">14.285714</span>  <span class="n">R</span><span class="p">,</span><span class="n">EQ</span><span class="o">.</span><span class="n">RATIO</span><span class="o">=</span> <span class="mf">1.322780</span>  <span class="n">PHI</span><span class="p">,</span><span class="n">EQ</span><span class="o">.</span><span class="n">RATIO</span><span class="o">=</span> <span class="mf">1.322780</span>

                 <span class="n">CHAMBER</span>   <span class="n">THROAT</span>     <span class="n">EXIT</span>
 <span class="n">Pinf</span><span class="o">/</span><span class="n">P</span>            <span class="mf">1.0000</span>   <span class="mf">1.7688</span>  <span class="mf">1110.26</span>
 <span class="n">P</span><span class="p">,</span> <span class="n">BAR</span>            <span class="mf">197.88</span>   <span class="mf">111.87</span>  <span class="mf">0.17823</span>
 <span class="n">T</span><span class="p">,</span> <span class="n">K</span>             <span class="mf">3594.37</span>  <span class="mf">3276.93</span>   <span class="mf">980.79</span>
 <span class="n">RHO</span><span class="p">,</span> <span class="n">KG</span><span class="o">/</span><span class="n">CU</span> <span class="n">M</span>    <span class="mf">9.0105</span> <span class="mi">0</span> <span class="mf">5.5875</span> <span class="mi">0</span> <span class="mf">2.9742</span><span class="o">-</span><span class="mi">2</span>
 <span class="n">H</span><span class="p">,</span> <span class="n">KJ</span><span class="o">/</span><span class="n">KG</span>         <span class="o">-</span><span class="mf">986.31</span> <span class="o">-</span><span class="mf">2182.76</span> <span class="o">-</span><span class="mf">9907.46</span>
 <span class="n">U</span><span class="p">,</span> <span class="n">KJ</span><span class="o">/</span><span class="n">KG</span>        <span class="o">-</span><span class="mf">3182.40</span> <span class="o">-</span><span class="mf">4184.90</span> <span class="o">-</span><span class="mf">10506.7</span>
 <span class="n">G</span><span class="p">,</span> <span class="n">KJ</span><span class="o">/</span><span class="n">KG</span>        <span class="o">-</span><span class="mf">62790.6</span> <span class="o">-</span><span class="mf">58528.7</span> <span class="o">-</span><span class="mf">26771.8</span>
 <span class="n">S</span><span class="p">,</span> <span class="n">KJ</span><span class="o">/</span><span class="p">(</span><span class="n">KG</span><span class="p">)(</span><span class="n">K</span><span class="p">)</span>    <span class="mf">17.1948</span>  <span class="mf">17.1948</span>  <span class="mf">17.1948</span>

 <span class="n">M</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>          <span class="mf">13.608</span>   <span class="mf">13.608</span>   <span class="mf">13.608</span>
 <span class="n">Cp</span><span class="p">,</span> <span class="n">KJ</span><span class="o">/</span><span class="p">(</span><span class="n">KG</span><span class="p">)(</span><span class="n">K</span><span class="p">)</span>    <span class="mf">3.7951</span>   <span class="mf">3.7416</span>   <span class="mf">2.7469</span>
 <span class="n">GAMMAs</span>            <span class="mf">1.1919</span>   <span class="mf">1.1952</span>   <span class="mf">1.2861</span>
 <span class="n">SON</span> <span class="n">VEL</span><span class="p">,</span><span class="n">M</span><span class="o">/</span><span class="n">SEC</span>     <span class="mf">1617.9</span>   <span class="mf">1546.9</span>    <span class="mf">877.9</span>
 <span class="n">MACH</span> <span class="n">NUMBER</span>        <span class="mf">0.000</span>    <span class="mf">1.000</span>    <span class="mf">4.812</span>

 <span class="n">PERFORMANCE</span> <span class="n">PARAMETERS</span>

 <span class="n">Ae</span><span class="o">/</span><span class="n">At</span>                      <span class="mf">1.0000</span>   <span class="mf">68.800</span>
 <span class="n">CSTAR</span><span class="p">,</span> <span class="n">M</span><span class="o">/</span><span class="n">SEC</span>               <span class="mf">2289.4</span>   <span class="mf">2289.4</span>
 <span class="n">CF</span>                         <span class="mf">0.6757</span>   <span class="mf">1.8450</span>
 <span class="n">Ivac</span><span class="p">,</span> <span class="n">M</span><span class="o">/</span><span class="n">SEC</span>                <span class="mf">2841.2</span>   <span class="mf">4365.9</span>
 <span class="n">Isp</span><span class="p">,</span> <span class="n">M</span><span class="o">/</span><span class="n">SEC</span>                 <span class="mf">1546.9</span>   <span class="mf">4224.0</span>

 <span class="n">MOLE</span> <span class="n">FRACTIONS</span>

 <span class="o">*</span><span class="n">H</span>              <span class="mf">0.02575</span>   <span class="n">HO2</span>             <span class="mf">0.00003</span>   <span class="o">*</span><span class="n">H2</span>             <span class="mf">0.24744</span>
 <span class="n">H2O</span>             <span class="mf">0.68555</span>   <span class="n">H2O2</span>            <span class="mf">0.00002</span>   <span class="o">*</span><span class="n">O</span>              <span class="mf">0.00207</span>
 <span class="o">*</span><span class="n">OH</span>             <span class="mf">0.03694</span>   <span class="o">*</span><span class="n">O2</span>             <span class="mf">0.00220</span>

  <span class="o">*</span> <span class="n">THERMODYNAMIC</span> <span class="n">PROPERTIES</span> <span class="n">FITTED</span> <span class="n">TO</span> <span class="mf">20000.</span><span class="n">K</span>

 <span class="n">NOTE</span><span class="o">.</span> <span class="n">WEIGHT</span> <span class="n">FRACTION</span> <span class="n">OF</span> <span class="n">FUEL</span> <span class="n">IN</span> <span class="n">TOTAL</span> <span class="n">FUELS</span> <span class="n">AND</span> <span class="n">OF</span> <span class="n">OXIDANT</span> <span class="n">IN</span> <span class="n">TOTAL</span> <span class="n">OXIDANTS</span>
</pre></div>
</div>
<p>The key properties include:</p>
<ul class="simple">
<li><p>C-star of 2289.4 m/s (based on combustion chamber conditions)</p></li>
<li><p>throat pressure of 111.87 bar and temperature of 3276.93 K</p></li>
<li><p>exit pressure of 0.17823 bar, temperature of 980.79 K</p></li>
<li><p>at the nozzle exit, thrust coefficient = 1.8450, Isp = 4224.0 m/s</p></li>
</ul>
<p>The reported specific impulse <span class="math notranslate nohighlight">\(I_{\textrm{sp}}\)</span> assumes that the ambient pressure is the same as the exit pressure, since CEA does not know the actual ambient pressure. (It also reports the specific impulse in vacuum, <span class="math notranslate nohighlight">\(I_{\textrm{vac}}\)</span>.)
The value is given in m/s and needs to be divided by the gravity constant to get our usual units of seconds:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Isp_cea</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mf">4224.0</span><span class="p">,</span> <span class="s1">&#39;m/s&#39;</span><span class="p">)</span>
<span class="n">Isp</span> <span class="o">=</span> <span class="n">Isp_cea</span> <span class="o">/</span> <span class="n">g0</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Isp = </span><span class="si">{</span><span class="n">Isp</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2"> .1f~P</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Isp = 430.7 s
</pre></div>
</div>
</div>
</div>
<p>The next thing to note is that CEA defaulted to assuming <strong>frozen</strong> mixture composition from the combustion chamber and throughout the nozzle; in other words, it is assuming that the equilibrium composition in the combustion chamber (based on chemical equilibrium) is the fixed composition throughout the whole nozzle.</p>
<p>However, in reality, the mixture composition will change because the temperature and pressure change throughout the nozzle. In the real system, these changes will be driven by chemical reactions occuring, but it is extremely challening to model these time-dependent effects.
Instead, an approximate <strong>shifting equilibrium</strong> approach can be taken, based on the assumption that the chemical reactions occur infinitely fast, and, therefore, at every location in the nozzle, the mixture composition is the equilibrium composition based on the local temperature and pressure.</p>
<p>CEA can use this approximation by selecting the <code class="docutils literal notranslate"><span class="pre">Equilibrium</span></code> rocket problem option. This produces:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>              THEORETICAL ROCKET PERFORMANCE ASSUMING EQUILIBRIUM

           COMPOSITION DURING EXPANSION FROM INFINITE AREA COMBUSTOR

 Pin =  2870.0 PSIA
 CASE = _______________

             REACTANT                    WT FRACTION      ENERGY      TEMP
                                          (SEE NOTE)     KJ/KG-MOL      K  
 FUEL        H2(L)                        1.0000000     -9012.000     20.270
 OXIDANT     O2(L)                        1.0000000    -12979.000     90.170

 O/F=    6.00000  %FUEL= 14.285714  R,EQ.RATIO= 1.322780  PHI,EQ.RATIO= 1.322780

                 CHAMBER   THROAT     EXIT
 Pinf/P            1.0000   1.7401   960.27
 P, BAR            197.88   113.71  0.20607
 T, K             3594.37  3378.30  1234.47
 RHO, KG/CU M    9.0105 0 5.5605 0 2.8330-2
 H, KJ/KG         -986.31 -2160.57 -10543.0
 U, KJ/KG        -3182.40 -4205.62 -11270.4
 G, KJ/KG        -62790.6 -60249.7 -31769.4
 S, KJ/(KG)(K)    17.1948  17.1948  17.1948

 M, (1/n)          13.608   13.735   14.111
 (dLV/dLP)t      -1.01921 -1.01432 -1.00000
 (dLV/dLT)p        1.3335   1.2644   1.0000
 Cp, KJ/(KG)(K)    7.3661   6.7421   2.9102
 GAMMAs            1.1472   1.1484   1.2539
 SON VEL,M/SEC     1587.2   1532.5    955.0
 MACH NUMBER        0.000    1.000    4.578

 PERFORMANCE PARAMETERS

 Ae/At                      1.0000   68.800
 CSTAR, M/SEC               2322.1   2322.1
 CF                         0.6599   1.8827
 Ivac, M/SEC                2867.0   4538.3
 Isp, M/SEC                 1532.5   4371.9


 MOLE FRACTIONS

 *H               0.02575  0.02063  0.00000
 HO2              0.00003  0.00002  0.00000
 *H2              0.24744  0.24496  0.24402
 H2O              0.68555  0.70439  0.75598
 H2O2             0.00002  0.00001  0.00000
 *O               0.00207  0.00126  0.00000
 *OH              0.03694  0.02734  0.00000
 *O2              0.00220  0.00140  0.00000
</pre></div>
</div>
<p>With the key properties:</p>
<ul class="simple">
<li><p>C-star of 2322.1 m/s (based on combustion chamber conditions)</p></li>
<li><p>exit pressure of 0.20607</p></li>
<li><p>at the nozzle exit, thrust coefficient = 1.8827, Isp = 4371.9 m/s</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Isp_cea</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mf">4371.9</span><span class="p">,</span> <span class="s1">&#39;m/s&#39;</span><span class="p">)</span>
<span class="n">Isp_eq</span> <span class="o">=</span> <span class="n">Isp_cea</span> <span class="o">/</span> <span class="n">g0</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Isp (equilibrium) = </span><span class="si">{</span><span class="n">Isp_eq</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2"> .1f~P</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Difference: </span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Isp_eq</span> <span class="o">-</span> <span class="n">Isp</span><span class="p">)</span><span class="o">/</span><span class="n">Isp</span><span class="si">:</span><span class="s2"> .2f~P</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Isp (equilibrium) = 445.8 s
Difference: 3.50%
</pre></div>
</div>
</div>
</div>
<p>The shifting equilibrium assumption typically overpredicts the real performance by 1–4%,
while the frozen composition assumption underpredicts performance by 1–4%.</p>
</div>
<div class="section" id="oxidizer-to-fuel-ratio">
<h2>Oxidizer-to-fuel ratio<a class="headerlink" href="#oxidizer-to-fuel-ratio" title="Permalink to this headline">¶</a></h2>
<p>The thermochemical performance of a rocket, represented by <span class="math notranslate nohighlight">\(c^*\)</span>, is a strong function of the oxidizer-to-fuel ratio, or <span class="math notranslate nohighlight">\(r = \)</span> O/F, and thus the overall performance (<span class="math notranslate nohighlight">\(I_{\textrm{sp}}\)</span>) also depends on the O/F ratio.
For liquid rockets, this ratio can be controlled directly since the propellants are injected separately.
CEA can help us identify the optimal O/F ratio.</p>
<p>For example, for the SSME considered above using liquid hydrogen and liquid oxygen, we can have CEA sweep over a range of O/F values, from 2 to 8 in increments of 0.25. This gives an input file of</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span> prob case=_______________8942 ro equilibrium
  
 # Pressure (1 value):
 p,psia= 2870
 # Supersonic Area Ratio (1 value):
 supar= 68.8
  
 # Oxidizer/Fuel Wt. ratio (25 values):
 o/f= 2, 2.25, 2.5, 2.75, 3, 3.25, 3.5, 3.75, 4, 4.25, 4.5, 4.75, 5, 5.25, 5.5, 5
 .75, 6, 6.25, 6.5, 6.75, 7, 7.25, 7.5, 7.75, 8
  
 reac
 fuel H2(L)             wt%=100.0000
 oxid O2(L)             wt%=100.0000
  
 output short
 # Proportions of any products will be expressed as Mole Fractions.
 # Heat will be expressed as siunits
 output siunits
  
 end
</pre></div>
</div>
<p>The output of CEA will be quite long, since there are 25 separate cases; the output is in the file <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">cea_OF_ratio_out.txt</span></code></span>. We can use Python to extract the desired information:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mixture_ratios</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">8.1</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;cea_OF_ratio_out.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

<span class="n">cstars</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">specific_impulses</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">specific_impulses_vac</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
    <span class="c1"># ignore blank lines</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
        <span class="k">continue</span>
    
    <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;CSTAR,&#39;</span><span class="p">:</span>
        <span class="n">cstars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
    <span class="k">elif</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Isp,&#39;</span><span class="p">:</span>
        <span class="n">specific_impulses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
    <span class="k">elif</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Ivac,&#39;</span><span class="p">:</span>
        <span class="n">specific_impulses_vac</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
<span class="n">cstars</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cstars</span><span class="p">),</span> <span class="s1">&#39;m/s&#39;</span><span class="p">)</span>
<span class="n">specific_impulses</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">specific_impulses</span><span class="p">),</span> <span class="s1">&#39;m/s&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="n">g0</span>
<span class="n">specific_impulses_vac</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">specific_impulses_vac</span><span class="p">),</span> <span class="s1">&#39;m/s&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="n">g0</span>

<span class="c1"># just checking that things line up</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">mixture_ratios</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">cstars</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">mixture_ratios</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">specific_impulses</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">mixture_ratios</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">specific_impulses_vac</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mixture_ratios</span><span class="p">,</span> <span class="n">to_si</span><span class="p">(</span><span class="n">cstars</span><span class="p">))</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$c^*$ (m/s)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mixture_ratios</span><span class="p">,</span> <span class="n">to_si</span><span class="p">(</span><span class="n">specific_impulses</span><span class="p">))</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$I_{\mathrm</span><span class="si">{sp}</span><span class="s1">}$ (s)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mixture_ratios</span><span class="p">,</span> <span class="n">to_si</span><span class="p">(</span><span class="n">specific_impulses_vac</span><span class="p">))</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;O/F ratio&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$I_{\mathrm</span><span class="si">{vac}</span><span class="s1">}$ (s)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/thermochemistry_22_0.png" src="../_images/thermochemistry_22_0.png" />
</div>
</div>
<p>This allows us to determine the mixture ratio for optimal performance, although in practice something slightly off-optimal might be used for other reasons (e.g., combustion stability, reducing peak temperature).</p>
</div>
<div class="section" id="frozen-vs-shifting-equilibrium">
<h2>Frozen vs. shifting equilibrium<a class="headerlink" href="#frozen-vs-shifting-equilibrium" title="Permalink to this headline">¶</a></h2>
<p>We have already seen how assuming the mixture composition either remains frozen from the combustion chamber or follows a shifting equilibrium model leads to different calculations of performance.
Frozen equilibrium underpredicts, while shifting equilibrium overpredicts.
We can use these together to estimate the true actual performance as somewhere in between, such as 40% of the difference between the two results.</p>
<p>We already have results for shifting equilibrum, and can similarly extract the specific impulse for frozen equilibrium calculations saved in <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">CEA_OF_ratio_frozen_out.txt</span></code></span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;CEA_OF_ratio_frozen_out.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

<span class="n">specific_impulses_frozen</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
    <span class="c1"># ignore blank lines</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
        <span class="k">continue</span>
    
    <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Isp,&#39;</span><span class="p">:</span>
        <span class="n">specific_impulses_frozen</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
<span class="n">specific_impulses_frozen</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">specific_impulses_frozen</span><span class="p">),</span> <span class="s1">&#39;m/s&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="n">g0</span>

<span class="c1"># just checking that things line up</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">mixture_ratios</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">specific_impulses_frozen</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">specific_impulses_act</span> <span class="o">=</span> <span class="n">specific_impulses_frozen</span> <span class="o">+</span> <span class="mf">0.4</span><span class="o">*</span><span class="p">(</span><span class="n">specific_impulses</span> <span class="o">-</span> <span class="n">specific_impulses_frozen</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mixture_ratios</span><span class="p">,</span> <span class="n">to_si</span><span class="p">(</span><span class="n">specific_impulses</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Shifting equilibrium&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mixture_ratios</span><span class="p">,</span> <span class="n">to_si</span><span class="p">(</span><span class="n">specific_impulses_frozen</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Frozen&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mixture_ratios</span><span class="p">,</span> <span class="n">to_si</span><span class="p">(</span><span class="n">specific_impulses_act</span><span class="p">),</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$I_{\mathrm</span><span class="si">{sp}</span><span class="s1">}$ (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Mixture ratio&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/thermochemistry_26_0.png" src="../_images/thermochemistry_26_0.png" />
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./thermochemistry"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="../fundamentals/ideal-rocket.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Ideal rocket analysis</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="cea_cantera.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Implementing CEA calculations using Cantera</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Kyle Niemeyer<br/>
    
      <div class="extra_footer">
        <p xmlns:dct="http://purl.org/dc/terms/" xmlns:cc="http://creativecommons.org/ns#" class="license-text"><a rel="cc:attributionURL" property="dct:title" href="https://github.com/kyleniemeyer/rocket-propulsion">Rocket Propulsion notes</a> by <span property="cc:attributionName">Kyle Niemeyer</span> is licensed under <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0">CC BY-SA 4.0<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1" /><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1" /><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1" /></a></p>

      </div>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>