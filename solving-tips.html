
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Problem-solving tips &#8212; Rocket Propulsion Notes</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Thrust and the rocket equation" href="fundamentals/thrust-rocket-equation.html" />
    <link rel="prev" title="Rocket Propulsion notes" href="intro.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Rocket Propulsion Notes</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Rocket Propulsion notes
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting started
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Problem-solving tips
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Fundamentals
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="fundamentals/thrust-rocket-equation.html">
   Thrust and the rocket equation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fundamentals/staging.html">
   Rocket staging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fundamentals/ideal-rocket.html">
   Ideal rocket analysis
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Thermochemistry
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="thermochemistry/thermochemistry.html">
   Thermochemistry
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="thermochemistry/cea_cantera.html">
   Implementing CEA calculations using Cantera
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chemical propulsion
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="chemical-rockets/hybrid-rockets.html">
   Hybrid Rocket Motors
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Reference
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="zbibliography.html">
   Bibliography
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="contributing.html">
   Contributing to this book
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/solving-tips.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/kyleniemeyer/rocket-propulsion"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/kyleniemeyer/rocket-propulsion/issues/new?title=Issue%20on%20page%20%2Fsolving-tips.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/kyleniemeyer/rocket-propulsion/edit/main/book/solving-tips.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/kyleniemeyer/rocket-propulsion/main?urlpath=tree/book/solving-tips.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#python-basics">
   Python basics
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#index">
   Index
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#arrays">
   Arrays
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mathematical-functions">
   Mathematical functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#working-with-units">
   Working with units
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plotting">
   Plotting
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solving-systems-of-equations">
   Solving systems of equations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#scalar-equations">
     Scalar equations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#systems-of-equations-vector-functions">
     Systems of equations / vector functions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#integrating-ode-systems">
   Integrating ODE systems
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#numerical-integral-of-samples">
     Numerical integral of samples
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#initial-value-problems">
     Initial value problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Problem-solving tips</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#python-basics">
   Python basics
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#index">
   Index
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#arrays">
   Arrays
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mathematical-functions">
   Mathematical functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#working-with-units">
   Working with units
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plotting">
   Plotting
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solving-systems-of-equations">
   Solving systems of equations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#scalar-equations">
     Scalar equations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#systems-of-equations-vector-functions">
     Systems of equations / vector functions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#integrating-ode-systems">
   Integrating ODE systems
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#numerical-integral-of-samples">
     Numerical integral of samples
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#initial-value-problems">
     Initial value problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="problem-solving-tips">
<h1>Problem-solving tips<a class="headerlink" href="#problem-solving-tips" title="Permalink to this headline">¶</a></h1>
<p>Solving problems will require using some basic Python concepts, along with resources provided by the NumPy and SciPy libraries. A few smaller modules like <code class="docutils literal notranslate"><span class="pre">pint</span></code> and <code class="docutils literal notranslate"><span class="pre">fluids</span></code> are also convenient, but not required.</p>
<div class="section" id="python-basics">
<h2>Python basics<a class="headerlink" href="#python-basics" title="Permalink to this headline">¶</a></h2>
<p>Although Python is a full programming language that can be used to develop sophisistated software packages, here we only really need to use it as a calculator. If you are not familiar with Python, I recommend starting with a <a class="reference external" href="https://docs.python.org/3/tutorial/introduction.html">basic introduction</a>.</p>
<p>If you have experience using Matlab, you can solve any problem with Python, but there are some <a class="reference external" href="https://realpython.com/matlab-vs-python/#syntax-differences-between-matlab-and-python">syntax differences</a> you should study.</p>
<p>The examples contained in this electronic book will integrate these techniques as needed, but this notebook contains some specific examples.</p>
</div>
<div class="section" id="index">
<h2>Index<a class="headerlink" href="#index" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p><a class="reference external" href="#arrays">Arrays</a></p></li>
<li><p><a class="reference external" href="#math-functions">Mathematical functions</a></p></li>
<li><p><a class="reference external" href="#working-with-units">Working with units</a></p></li>
<li><p><a class="reference external" href="#plotting">Plotting</a></p></li>
<li><p><a class="reference external" href="#solving-systems-of-equations">Solving systems of equations</a></p></li>
<li><p><a class="reference external" href="#integrating-ode-systems">Integrating ODE systems</a></p></li>
</ol>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>The <a class="reference external" href="https://scipy-lectures.org"><em>SciPy Lecture Notes</em></a> are excellent, detailed resources on all these topics, and Python programming in general <span id="id1">[]</span>.</p>
</div>
</div>
<div class="section" id="arrays">
<h2>Arrays<a class="headerlink" href="#arrays" title="Permalink to this headline">¶</a></h2>
<p>Python provides lists as a basic data type, which can be handy due to their ability to  flexibly store different types of variables and change size.
However, for numerical calculations, they can be quite slow, and we often need to apply the same calculation to all elements of a group of numbers.
Enter NumPy’s <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> (or <code class="docutils literal notranslate"><span class="pre">numpy.array</span></code>), and <a class="reference external" href="https://realpython.com/matlab-vs-python/#an-overview-of-basic-array-operations">array operations</a>.</p>
<p>Let’s say we want to create an array of arbitrary numbers. We can do this by wrapping a list:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this is an extremely common shortcut for importing numpy</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">275</span><span class="p">,</span> <span class="mi">300</span><span class="p">])</span>

<span class="k">for</span> <span class="n">temp</span> <span class="ow">in</span> <span class="n">temps</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100
200
250
275
300
</pre></div>
</div>
</div>
</div>
<p>Now, let’s say we want to double all values of that array. This would require a loop to do with regular Python lists, but with arrays it is as simple as</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_temps</span> <span class="o">=</span> <span class="n">temps</span> <span class="o">*</span> <span class="mi">2</span>
<span class="k">for</span> <span class="n">temp</span> <span class="ow">in</span> <span class="n">new_temps</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>200
400
500
550
600
</pre></div>
</div>
</div>
</div>
<p>NumPy also provides some handy functions to quickly create arrays, including:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html"><code class="docutils literal notranslate"><span class="pre">np.zeros(num)</span></code></a>: create an array of zeros, length <code class="docutils literal notranslate"><span class="pre">num</span></code></p></li>
<li><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros_like.html"><code class="docutils literal notranslate"><span class="pre">np.zeros_like(a)</span></code></a>: creates an array of zeros, with the same size and shape as <code class="docutils literal notranslate"><span class="pre">a</span></code></p></li>
<li><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html"><code class="docutils literal notranslate"><span class="pre">np.ones(num)</span></code></a>: create an array of ones, length <code class="docutils literal notranslate"><span class="pre">num</span></code></p></li>
<li><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html"><code class="docutils literal notranslate"><span class="pre">np.linspace(start,</span> <span class="pre">stop,</span> <span class="pre">num=50)</span></code></a>: create an array of <code class="docutils literal notranslate"><span class="pre">num</span></code> evenly spaced numbers, from <code class="docutils literal notranslate"><span class="pre">start</span></code> to <code class="docutils literal notranslate"><span class="pre">stop</span></code></p></li>
<li><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html"><code class="docutils literal notranslate"><span class="pre">np.arange(start,</span> <span class="pre">stop,</span> <span class="pre">step)</span></code></a>: create an array of numbers, from <code class="docutils literal notranslate"><span class="pre">start</span></code> to just before <code class="docutils literal notranslate"><span class="pre">stop</span></code>, separated by <code class="docutils literal notranslate"><span class="pre">step</span></code></p></li>
</ul>
<p>Plus a few other more specialized functions (e.g., even spacing in logarithmic scale).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zeros</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">zeros</span><span class="p">)</span>

<span class="n">ones</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ones</span><span class="p">)</span>

<span class="n">temps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">])</span>
<span class="n">zeros2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">temps</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">zeros2</span><span class="p">)</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0. 0. 0. 0. 0.]
[1. 1. 1. 1. 1.]
[0. 0. 0. 0.]
[0.         0.22222222 0.44444444 0.66666667 0.88888889 1.11111111
 1.33333333 1.55555556 1.77777778 2.        ]
[0.  0.2 0.4 0.6 0.8]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="mathematical-functions">
<h2>Mathematical functions<a class="headerlink" href="#mathematical-functions" title="Permalink to this headline">¶</a></h2>
<p>NumPy provides a large number of <a class="reference external" href="https://numpy.org/doc/stable/reference/routines.math.html">mathematical functions</a>, that can operate on scalars and also arrays:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">60</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">90</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angles</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5000000000000001
[0.25881905 0.5        0.70710678 0.8660254  1.        ]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="working-with-units">
<h2>Working with units<a class="headerlink" href="#working-with-units" title="Permalink to this headline">¶</a></h2>
<p>Nearly all calculations we do involve units. <a class="reference external" href="https://pint.readthedocs.io/">Pint</a> is a useful tool for parsing unit expressions, converting between different units, and working with expressions involving quantities (values + units).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pint</span> <span class="kn">import</span> <span class="n">UnitRegistry</span>
<span class="n">ureg</span> <span class="o">=</span> <span class="n">UnitRegistry</span><span class="p">()</span>
<span class="n">Q_</span> <span class="o">=</span> <span class="n">ureg</span><span class="o">.</span><span class="n">Quantity</span> <span class="c1"># We will use this to construct quantities (value + unit)</span>
</pre></div>
</div>
</div>
</div>
<p>We can specify units by multiplying the value by an object with the unit (as a member of the <code class="docutils literal notranslate"><span class="pre">ureg</span></code> object, which is an instance of the <code class="docutils literal notranslate"><span class="pre">UnitRegistry</span></code> class):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distance</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">ureg</span><span class="o">.</span><span class="n">meter</span>
<span class="nb">print</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10 meter
</pre></div>
</div>
</div>
</div>
<p>A slightly more convenient way of creating units is to define a <code class="docutils literal notranslate"><span class="pre">Quantity</span></code> shortcut, here done with <code class="docutils literal notranslate"><span class="pre">Q_</span></code>, and use that to create the unit:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distance</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10 meter
</pre></div>
</div>
</div>
</div>
<p>For example, we can read in expressions that give temperature and pressure in US customary units (e.g., imperial units) and then convert those to SI units:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;degF&#39;</span><span class="p">)</span>
<span class="n">pressure</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="s1">&#39;10 psi&#39;</span><span class="p">)</span>

<span class="n">new_temperature</span> <span class="o">=</span> <span class="n">temperature</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">)</span>
<span class="n">new_pressure</span> <span class="o">=</span> <span class="n">pressure</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;Pa&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Temperature in SI: </span><span class="si">{</span><span class="n">new_temperature</span><span class="si">:</span><span class="s1"> .2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Pressure in SI: </span><span class="si">{</span><span class="n">new_pressure</span><span class="si">:</span><span class="s1"> .2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Temperature in SI: 310.93 kelvin
Pressure in SI: 68947.57 pascal
</pre></div>
</div>
</div>
</div>
<p>Pint interprets nearly all properties either written out (e.g., <code class="docutils literal notranslate"><span class="pre">kelvin</span></code>, <code class="docutils literal notranslate"><span class="pre">meters</span></code>) or as abbreviations (e.g., <code class="docutils literal notranslate"><span class="pre">K</span></code>, <code class="docutils literal notranslate"><span class="pre">m</span></code>)—except for temperatures. In that case, we need to use <code class="docutils literal notranslate"><span class="pre">kelvin</span></code> or <code class="docutils literal notranslate"><span class="pre">K</span></code>, <code class="docutils literal notranslate"><span class="pre">celsius</span></code> or <code class="docutils literal notranslate"><span class="pre">degC</span></code>, <code class="docutils literal notranslate"><span class="pre">fahrenheits</span></code> or <code class="docutils literal notranslate"><span class="pre">degF</span></code>, and <code class="docutils literal notranslate"><span class="pre">rankine</span></code> or <code class="docutils literal notranslate"><span class="pre">degR</span></code>.</p>
<p>Pint also handles mathematical operations between physical quantities:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distance1</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">)</span>
<span class="n">distance2</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;cm&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">distance1</span> <span class="o">+</span> <span class="n">distance2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.1 meter
</pre></div>
</div>
</div>
</div>
<p>When working with quantities, you may find that printed output may not express values in the desired units. In that case, you can easy convert to desired units using the <code class="docutils literal notranslate"><span class="pre">.to()</span></code> method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mass</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;kg&#39;</span><span class="p">)</span>
<span class="n">velocity</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;m/s&#39;</span><span class="p">)</span>
<span class="n">kinetic_energy</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">mass</span> <span class="o">*</span> <span class="n">velocity</span><span class="o">**</span><span class="mi">2</span>

<span class="nb">print</span><span class="p">(</span><span class="n">kinetic_energy</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">kinetic_energy</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;joule&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.0 kilogram * meter ** 2 / second ** 2
2.0 joule
</pre></div>
</div>
</div>
</div>
<p>Although most base NumPy array operations and math can work with units just fine, when you try to use with SciPy solvers (equation solvers, ODE integrators, interpolation, curve fitting, etc.), you will find that they do not like the units and will report an error.</p>
<p>The easiest way to handle this is to convert your inputs to SI units, and strip off the units themselves. We can do this by defining a convenience function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># for convenience:</span>
<span class="k">def</span> <span class="nf">to_si</span><span class="p">(</span><span class="n">quant</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Converts a Pint Quantity to magnitude at base SI units.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">quant</span><span class="o">.</span><span class="n">to_base_units</span><span class="p">()</span><span class="o">.</span><span class="n">magnitude</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pressure</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;psi&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pressure</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">to_si</span><span class="p">(</span><span class="n">pressure</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>20 pound_force_per_square_inch
137895.14586336727
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="plotting">
<h2>Plotting<a class="headerlink" href="#plotting" title="Permalink to this headline">¶</a></h2>
<p>We can use <a class="reference external" href="https://matplotlib.org">Matplotlib</a> to produce nice plots of our results. If you used Anaconda to set up your computing environment, you likely already have Matplotlib installed; if not, see their <a class="reference external" href="https://matplotlib.org/users/installing.html">installation instructions</a>.</p>
<p>Matplotlib provides an interface that is very similar to what you might already know from Matlab: <code class="docutils literal notranslate"><span class="pre">pyplot</span></code>. You can import this in Python files or a Jupyter notebook with the standard abbreviation <code class="docutils literal notranslate"><span class="pre">plt</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this line makes figures interactive in Jupyter notebooks</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># these lines are only for helping improve the display</span>
<span class="kn">import</span> <span class="nn">matplotlib_inline.backend_inline</span>
<span class="n">matplotlib_inline</span><span class="o">.</span><span class="n">backend_inline</span><span class="o">.</span><span class="n">set_matplotlib_formats</span><span class="p">(</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span> <span class="s1">&#39;png&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span><span class="o">=</span> <span class="mi">300</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;savefig.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">300</span>
</pre></div>
</div>
</div>
</div>
<p>For example, let’s generate some values of an independent variable <span class="math notranslate nohighlight">\(x\)</span> linearly spaced between 0 and 10 (using the NumPy function <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.linspace.html"><code class="docutils literal notranslate"><span class="pre">linspace()</span></code></a>), and then plot the function <span class="math notranslate nohighlight">\(y(x) = \sin(x)\)</span>. We can also add labels to the axes, a legend, and a helpful grid.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;y(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x axis&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y axis&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/solving-tips_33_0.png" src="_images/solving-tips_33_0.png" />
</div>
</div>
<p>We can also plot multiple data series in a single figure:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;sin(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;cos(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x axis&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y axis&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/solving-tips_35_0.png" src="_images/solving-tips_35_0.png" />
</div>
</div>
<p>Or, we can use subplots to plot multiple axes in the same overall figure:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 2 rows, 1 column</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;sin(x)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;sin(x)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;cos(x)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x axis&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;cos(x)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/solving-tips_37_0.png" src="_images/solving-tips_37_0.png" />
</div>
</div>
</div>
<div class="section" id="solving-systems-of-equations">
<h2>Solving systems of equations<a class="headerlink" href="#solving-systems-of-equations" title="Permalink to this headline">¶</a></h2>
<p>Frequently we will encounter a system of one or more equations that involves an equal number of unknowns. If this is a linear system of equations, we can use linear algebra and the NumPy <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.linalg.solve.html"><code class="docutils literal notranslate"><span class="pre">linalg.solve()</span></code></a> function, but more often in thermodynamics we encounter complex and/or nonlinear systems.</p>
<p>In cases like this, we will need to set up our problems to find the roots, or zeroes, of the function(s); in other words, given a function <span class="math notranslate nohighlight">\( f(x) \)</span>, finding the root means to find the value of <span class="math notranslate nohighlight">\(x\)</span> such that <span class="math notranslate nohighlight">\( f(x) = 0 \)</span>. If we are dealing with a system of equations and the same number of unknowns, then these would be vectors: <span class="math notranslate nohighlight">\(\mathbf{f}(\mathbf{x}) = 0\)</span>.</p>
<p>(You might be wondering what to do about equations that don’t equal zero… for example, if you have something like <span class="math notranslate nohighlight">\(f(x) = g(x)\)</span>. In this case, you just need to manipulate the equation to be in the form <span class="math notranslate nohighlight">\(f(x) - g(x) = 0\)</span>.)</p>
<p>The <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.html">SciPy optimization module</a> provides functions to find roots of equations; for scalar equations, we can use <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.root_scalar.html#scipy.optimize.root_scalar"><code class="docutils literal notranslate"><span class="pre">root_scalar()</span></code></a>, and for vector equations, we can use <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.root.html"><code class="docutils literal notranslate"><span class="pre">root()</span></code></a>.</p>
<div class="section" id="scalar-equations">
<h3>Scalar equations<a class="headerlink" href="#scalar-equations" title="Permalink to this headline">¶</a></h3>
<p>Let’s first look at an example of a scalar function: one equation, one unknown.</p>
<p>Find the root of this equation:</p>
<div class="amsmath math notranslate nohighlight" id="equation-ee19c081-ad24-4095-987e-de9775904795">
<span class="eqno">(1)<a class="headerlink" href="#equation-ee19c081-ad24-4095-987e-de9775904795" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\cos(x) = x^3
\end{equation}\]</div>
<p>We need to create a Python function that returns <span class="math notranslate nohighlight">\(f(x) = 0\)</span>, so that the function returns zero when the input value of <span class="math notranslate nohighlight">\(x\)</span> is the (correct) root. Then, we can use the <code class="docutils literal notranslate"><span class="pre">root_scalar</span></code> function with some initial guesses.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>

<span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span>

<span class="n">sol</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">root_scalar</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Root: x =</span><span class="si">{</span><span class="n">sol</span><span class="o">.</span><span class="n">root</span><span class="si">:</span><span class="s1"> .3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Function evaluated at root: </span><span class="si">{</span><span class="n">func</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">root</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Root: x = 0.865
Function evaluated at root: 1.1102230246251565e-16
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="systems-of-equations-vector-functions">
<h3>Systems of equations / vector functions<a class="headerlink" href="#systems-of-equations-vector-functions" title="Permalink to this headline">¶</a></h3>
<p>We can also solve systems of equations in a similar fashion using the SciPy <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.root.html"><code class="docutils literal notranslate"><span class="pre">root()</span></code></a> functino, where we find the roots <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> that satisfy <span class="math notranslate nohighlight">\(\mathbf{f} (\mathbf{x}) = 0\)</span>.</p>
<p>For example, let’s try to find the values of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> that satisfy these equations:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
x \ln (x) &amp;= y^3 \\
\sqrt{x} &amp;= \frac{1}{y}
\end{align*}
\end{split}\]</div>
<p>We have two equations and two unknowns, so we should be able to find the roots.</p>
<p>To solve, we create a function that evaluates these equations when made equal to zero, or</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
x \ln (x) - y^3 &amp;= 0 \\
\sqrt{x} - \frac{1}{y} &amp;= 0
\end{align*}
\end{split}\]</div>
<p>then we call <code class="docutils literal notranslate"><span class="pre">root</span></code> specifying this function and two initial guesses for <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>

<span class="k">def</span> <span class="nf">system</span><span class="p">(</span><span class="nb">vars</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">x</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">y</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">y</span><span class="p">)</span>
        <span class="p">]</span>

<span class="n">sol</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">root</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Roots: x = </span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s1"> .3f</span><span class="si">}</span><span class="s1">, y = </span><span class="si">{</span><span class="n">y</span><span class="si">:</span><span class="s1"> .3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Roots: x =  1.467, y =  0.826
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="integrating-ode-systems">
<h2>Integrating ODE systems<a class="headerlink" href="#integrating-ode-systems" title="Permalink to this headline">¶</a></h2>
<p>In some cases, we encounter problems that require integrating one or more ordinary different equations in time. Depending on the form of the problem, we may need to integrate a function between two points (definite integral), or we may have a system of ordinary differential equations.</p>
<div class="section" id="numerical-integral-of-samples">
<h3>Numerical integral of samples<a class="headerlink" href="#numerical-integral-of-samples" title="Permalink to this headline">¶</a></h3>
<p>In some cases we have a set of <span class="math notranslate nohighlight">\((x,y)\)</span> data that we want to integrate numerically.
We can do this using the NumPy <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.trapz.html"><code class="docutils literal notranslate"><span class="pre">trapz()</span></code> function</a>, which implements the composite trapezoidal rule.</p>
<p>For example, let’s consider a situation where a reciprocating compressor is being used to compress ammonia vapor during a refrigeration cycle. We have some experimental measurements of the pressure-volume data during the compression stroke (see table), and we want to determine the work done on the ammonia by the piston.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Pressure (psi)</p></th>
<th class="head"><p>Volume (in^3)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>65.1</p></td>
<td><p>80.0</p></td>
</tr>
<tr class="row-odd"><td><p>80.5</p></td>
<td><p>67.2</p></td>
</tr>
<tr class="row-even"><td><p>93.2</p></td>
<td><p>60.1</p></td>
</tr>
<tr class="row-odd"><td><p>110</p></td>
<td><p>52.5</p></td>
</tr>
<tr class="row-even"><td><p>134</p></td>
<td><p>44.8</p></td>
</tr>
<tr class="row-odd"><td><p>161</p></td>
<td><p>37.6</p></td>
</tr>
<tr class="row-even"><td><p>190</p></td>
<td><p>32.5</p></td>
</tr>
</tbody>
</table>
<p>To find the work done by the piston to the ammonia, we can integrate pressure with respect to volume:</p>
<div class="amsmath math notranslate nohighlight" id="equation-c332ce28-4c5a-4d65-8bae-3c2372fbaa8f">
<span class="eqno">(2)<a class="headerlink" href="#equation-c332ce28-4c5a-4d65-8bae-3c2372fbaa8f" title="Permalink to this equation">¶</a></span>\[\begin{equation}
W_{\text{in}} = -\int_{V_1}^{V_2} P \, dV
\end{equation}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">pressure</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">([</span><span class="mf">65.1</span><span class="p">,</span> <span class="mf">80.5</span><span class="p">,</span> <span class="mf">93.2</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">134</span><span class="p">,</span> <span class="mi">161</span><span class="p">,</span> <span class="mi">190</span><span class="p">],</span> <span class="s1">&#39;psi&#39;</span><span class="p">)</span>
<span class="n">volume</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">([</span><span class="mf">80.0</span><span class="p">,</span> <span class="mf">67.2</span><span class="p">,</span> <span class="mf">60.1</span><span class="p">,</span> <span class="mf">52.5</span><span class="p">,</span> <span class="mf">44.8</span><span class="p">,</span> <span class="mf">37.6</span><span class="p">,</span> <span class="mf">32.5</span><span class="p">],</span> <span class="s1">&#39;in^3&#39;</span><span class="p">)</span>

<span class="c1"># convert to SI units</span>
<span class="n">pressure</span><span class="o">.</span><span class="n">ito</span><span class="p">(</span><span class="s1">&#39;Pa&#39;</span><span class="p">)</span>
<span class="n">volume</span><span class="o">.</span><span class="n">ito</span><span class="p">(</span><span class="s1">&#39;m^3&#39;</span><span class="p">)</span>

<span class="n">work</span> <span class="o">=</span> <span class="o">-</span><span class="n">Q_</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">pressure</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">volume</span><span class="o">.</span><span class="n">magnitude</span><span class="p">),</span> 
    <span class="n">pressure</span><span class="o">.</span><span class="n">units</span> <span class="o">*</span> <span class="n">volume</span><span class="o">.</span><span class="n">units</span>
    <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Work done on fluid: </span><span class="si">{</span><span class="n">work</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;J&quot;</span><span class="p">)</span><span class="si">:</span><span class="s1"> .2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Work done on fluid: 589.45 joule
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Notice the use of the <code class="docutils literal notranslate"><span class="pre">.ito()</span></code> methods, which convert the units of a quantity in place.</p>
</div>
<p>We can also numerically integrate expressions/functions using the SciPy <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html"><code class="docutils literal notranslate"><span class="pre">quad()</span></code> function</a>, also in the <code class="docutils literal notranslate"><span class="pre">integrate</span></code> module.</p>
<p>Let’s build on the previous example: first, let’s fit the compressor data to the polytropic form <span class="math notranslate nohighlight">\(P V^n = c\)</span>, where <span class="math notranslate nohighlight">\(c\)</span> and <span class="math notranslate nohighlight">\(n\)</span> are constants, then we can integrate the resulting function to calculate work.</p>
<p>To fit the data, we need to rearrange the equation to the form <span class="math notranslate nohighlight">\(y = f(x)\)</span>:</p>
<div class="amsmath math notranslate nohighlight" id="equation-852d5d3a-6a8b-4298-86d5-eabada0913c6">
<span class="eqno">(3)<a class="headerlink" href="#equation-852d5d3a-6a8b-4298-86d5-eabada0913c6" title="Permalink to this equation">¶</a></span>\[\begin{equation}
P = c V^{-n}
\end{equation}\]</div>
<p>We’ll use the <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html"><code class="docutils literal notranslate"><span class="pre">scipy.optimize.curve_fit()</span></code></a> function for that.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># for convenience:</span>
<span class="k">def</span> <span class="nf">to_si</span><span class="p">(</span><span class="n">quant</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Converts a Pint Quantity to magnitude at base SI units.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">quant</span><span class="o">.</span><span class="n">to_base_units</span><span class="p">()</span><span class="o">.</span><span class="n">magnitude</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>

<span class="kn">from</span> <span class="nn">pint</span> <span class="kn">import</span> <span class="n">UnitRegistry</span>
<span class="n">ureg</span> <span class="o">=</span> <span class="n">UnitRegistry</span><span class="p">()</span>
<span class="n">Q_</span> <span class="o">=</span> <span class="n">ureg</span><span class="o">.</span><span class="n">Quantity</span>

<span class="n">pressure</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">([</span><span class="mf">65.1</span><span class="p">,</span> <span class="mf">80.5</span><span class="p">,</span> <span class="mf">93.2</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">134</span><span class="p">,</span> <span class="mi">161</span><span class="p">,</span> <span class="mi">190</span><span class="p">],</span> <span class="s1">&#39;psi&#39;</span><span class="p">)</span>
<span class="n">volume</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">([</span><span class="mf">80.0</span><span class="p">,</span> <span class="mf">67.2</span><span class="p">,</span> <span class="mf">60.1</span><span class="p">,</span> <span class="mf">52.5</span><span class="p">,</span> <span class="mf">44.8</span><span class="p">,</span> <span class="mf">37.6</span><span class="p">,</span> <span class="mf">32.5</span><span class="p">],</span> <span class="s1">&#39;in^3&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Evaluate P = c * V**(-n). </span>
<span class="sd">    </span>
<span class="sd">    n and c will be found by the curve_fit functino.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">c</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="o">-</span><span class="n">n</span><span class="p">)</span>

<span class="c1"># this function will automatically fit the unknown constants</span>
<span class="n">params</span><span class="p">,</span> <span class="n">cov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">to_si</span><span class="p">(</span><span class="n">volume</span><span class="p">),</span> <span class="n">to_si</span><span class="p">(</span><span class="n">pressure</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parameters: n=</span><span class="si">{</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1"> 5.3f</span><span class="si">}</span><span class="s1">, c=</span><span class="si">{</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1"> 5.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Parameters: n= 1.170, c= 194.200
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2860/1606160274.py:17: RuntimeWarning: overflow encountered in power
  return c * np.power(V, -n)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">to_si</span><span class="p">(</span><span class="n">volume</span><span class="p">),</span> <span class="n">to_si</span><span class="p">(</span><span class="n">pressure</span><span class="p">),</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data&#39;</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">to_si</span><span class="p">(</span><span class="n">volume</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">to_si</span><span class="p">(</span><span class="n">volume</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># plot data and fit</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span>
         <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;fit: n=</span><span class="si">{</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1"> 5.3f</span><span class="si">}</span><span class="s1">, c=</span><span class="si">{</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1"> 5.3f</span><span class="si">}</span><span class="s1">&#39;</span>
         <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Volume (m^3)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pressure (Pa)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;sci&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">scilimits</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/solving-tips_50_0.png" src="_images/solving-tips_50_0.png" />
</div>
</div>
<p>That looks like a great fit to the data, so now let’s evaluate the work by integrating:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span>
    <span class="n">fit</span><span class="p">,</span> <span class="n">to_si</span><span class="p">(</span><span class="n">volume</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">to_si</span><span class="p">(</span><span class="n">volume</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> 
    <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="p">)</span>

<span class="n">work</span> <span class="o">=</span> <span class="o">-</span><span class="n">Q_</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="s1">&#39;J&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Work done on fluid: </span><span class="si">{</span><span class="n">work</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;J&quot;</span><span class="p">)</span><span class="si">:</span><span class="s1"> .2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Work done on fluid: 586.26 joule
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="initial-value-problems">
<h3>Initial value problems<a class="headerlink" href="#initial-value-problems" title="Permalink to this headline">¶</a></h3>
<p>In other words, we may have a system like</p>
<div class="amsmath math notranslate nohighlight" id="equation-cd74056e-2fce-4f14-b542-b2350394f05c">
<span class="eqno">(4)<a class="headerlink" href="#equation-cd74056e-2fce-4f14-b542-b2350394f05c" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\frac{d \mathbf{y}}{dt} = \mathbf{f} (t, \mathbf{y})
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{y}\)</span> is the vector of state variables, for which we should have the initial values (<span class="math notranslate nohighlight">\(\mathbf{y}(t=0)\)</span>). In this case, we can use the SciPy function <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.solve_ivp.html"><code class="docutils literal notranslate"><span class="pre">solve_ivp()</span></code> function</a>, part of the <code class="docutils literal notranslate"><span class="pre">integrate</span></code> module.</p>
<p>For example, let’s consider a problem where we want to find the volume of water, volume of air, and pressure in a tank as a function of time, as the tank releases water to an environment. The volumetric flow rate through the tank’s valve is based on its instantaneous pressure:</p>
<div class="math notranslate nohighlight">
\[
\dot{V}_f = \frac{P - P_{\text{atm}}}{R_v} \;,
\]</div>
<p>where <span class="math notranslate nohighlight">\(P_{\text{atm}}\)</span> is atmospheric pressure and <span class="math notranslate nohighlight">\(R_v = 10\)</span> psi/gpm is the valve resistance parameter. The tank has volume 50 gal, and is initially filled with water (volume fraction <span class="math notranslate nohighlight">\(f\)</span> = 0.8); the air in the tank is initially at 100 psi. We will treat the air as an ideal gas, and the water as an incompressible substance.</p>
<p>We have the initial air pressure, and we can calculate the initial volumes of water and air:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
V_{f,0} &amp;= f \, V \\
V_{g,0} &amp;= (1 - f) V
\end{align*}
\end{split}\]</div>
<p>We can perform a mass balance on the water in the tank to obtain a rate equation for the volume of water:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
0 &amp;= \dot{m}_f + \frac{d m_f}{dt} = \dot{V}_f \rho_f + \rho_f \frac{d V_f}{dt} \\
0 &amp;= \dot{V}_f + \frac{dV_f}{dt} \\
\therefore \frac{dV_f}{dt} &amp;= -\frac{(P - P_{\text{atm}})}{R_v}
\end{align*}
\end{split}\]</div>
<p>Since the overall volume of the tank is constant, we can obtain the rate of change of the volume of air:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{gather*}
V = V_g + V_f \\
\frac{dV_g}{dt} + \frac{dV_f}{dt} = 0 \\
\therefore \frac{dV_g}{dt} = -\frac{dV_f}{dt}
\end{gather*}
\end{split}\]</div>
<p>Finally, a mass balance on the air in the tank allows us to find the rate of change of pressure:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
0 &amp;= \frac{dm_a}{dt} \\
0 &amp;= \frac{d}{dt} \left( \frac{P V_g}{R T} \right) \\
0 &amp;= V_g \frac{dP}{dt} + P \frac{dV_g}{dt} \\
\therefore \frac{dP}{dt} &amp;= -\frac{P}{V_g} \frac{dV_g}{dt}
\end{align*}
\end{split}\]</div>
<p>Now, we can integrate this system of ODEs:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pint</span> <span class="kn">import</span> <span class="n">UnitRegistry</span>
<span class="n">ureg</span> <span class="o">=</span> <span class="n">UnitRegistry</span><span class="p">()</span>
<span class="n">Q_</span> <span class="o">=</span> <span class="n">ureg</span><span class="o">.</span><span class="n">Quantity</span>

<span class="c1"># initial conditions and constants</span>
<span class="n">valve_resistance</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;psi/(gal/min)&#39;</span><span class="p">)</span>
<span class="n">pressure_atmosphere</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;atm&#39;</span><span class="p">)</span>

<span class="n">volume_tank</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;gal&#39;</span><span class="p">)</span>
<span class="n">water_fraction</span> <span class="o">=</span> <span class="mf">0.8</span>

<span class="n">pressure_initial</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;psi&#39;</span><span class="p">)</span>
<span class="n">volume_water_initial</span> <span class="o">=</span> <span class="n">water_fraction</span> <span class="o">*</span> <span class="n">volume_tank</span>
<span class="n">volume_air_initial</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">water_fraction</span><span class="p">)</span> <span class="o">*</span> <span class="n">volume_tank</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">tank_equations</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">valve_resistance</span><span class="p">,</span> <span class="n">pressure_atmosphere</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Rates of change for water volume, air volume, and air pressure in tank.</span>
<span class="sd">    </span>
<span class="sd">    Input values in SI units.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">volume_water</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;m^3&#39;</span><span class="p">)</span>
    <span class="n">volume_air</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;m^3&#39;</span><span class="p">)</span>
    <span class="n">pressure_air</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;Pa&#39;</span><span class="p">)</span>
    
    <span class="n">dVf_dt</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">pressure_air</span> <span class="o">-</span> <span class="n">pressure_atmosphere</span><span class="p">)</span> <span class="o">/</span> <span class="n">valve_resistance</span>
    <span class="n">dVg_dt</span> <span class="o">=</span> <span class="o">-</span><span class="n">dVf_dt</span>
    <span class="n">dP_dt</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">pressure_air</span> <span class="o">/</span> <span class="n">volume_air</span><span class="p">)</span> <span class="o">*</span> <span class="n">dVg_dt</span>
    
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">to_si</span><span class="p">(</span><span class="n">dVf_dt</span><span class="p">),</span> 
        <span class="n">to_si</span><span class="p">(</span><span class="n">dVg_dt</span><span class="p">),</span>
        <span class="n">to_si</span><span class="p">(</span><span class="n">dP_dt</span><span class="p">)</span>
        <span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Now that we have the initial conditions and rate function set up, we can integrate in time. Let’s do this for 500 seconds, and then plot the water volume and tank pressure as functions of time:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_ivp</span>

<span class="c1"># now integrate for 500 seconds, specifying the function, time interval, </span>
<span class="c1">#initial conditions, and additional arguments to the function</span>

<span class="n">sol</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span>
    <span class="n">tank_equations</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">500.0</span><span class="p">],</span>
    <span class="p">[</span><span class="n">to_si</span><span class="p">(</span><span class="n">volume_water_initial</span><span class="p">),</span> 
     <span class="n">to_si</span><span class="p">(</span><span class="n">volume_air_initial</span><span class="p">),</span> 
     <span class="n">to_si</span><span class="p">(</span><span class="n">pressure_initial</span><span class="p">)</span>
     <span class="p">],</span>
    <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">valve_resistance</span><span class="p">,</span> <span class="n">pressure_atmosphere</span><span class="p">,),</span>
    <span class="n">method</span><span class="o">=</span><span class="s1">&#39;BDF&#39;</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">t</span>
<span class="n">volume_water</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;m^3&#39;</span><span class="p">)</span>
<span class="n">volume_air</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;m^3&#39;</span><span class="p">)</span>
<span class="n">pressure</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;Pa&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">pressure</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;psi&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Tank pressure (psi)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">volume_water</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;gal&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Water volume (gal)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Water volume (gal) and tank pressure (psi)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ymin</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span> <span class="c1"># ensure lower y-axis bound is zero</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/solving-tips_58_0.png" src="_images/solving-tips_58_0.png" />
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="intro.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Rocket Propulsion notes</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="fundamentals/thrust-rocket-equation.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Thrust and the rocket equation</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Kyle Niemeyer<br/>
    
      <div class="extra_footer">
        <p xmlns:dct="http://purl.org/dc/terms/" xmlns:cc="http://creativecommons.org/ns#" class="license-text"><a rel="cc:attributionURL" property="dct:title" href="https://github.com/kyleniemeyer/rocket-propulsion">Rocket Propulsion notes</a> by <span property="cc:attributionName">Kyle Niemeyer</span> is licensed under <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0">CC BY-SA 4.0<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1" /><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1" /><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1" /></a></p>

      </div>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>